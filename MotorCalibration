#include <Servo.h>

#define MAX_SIGNAL 2000
#define MIN_SIGNAL 1000
#define MY_Min 1050
#define MOTOR1_PIN 2 
#define MOTOR2_PIN 5
#define MOTOR3_PIN 7
#define MOTOR4_PIN 9

int DELAY = 1000;

Servo motor1;
Servo motor2;
Servo motor3;
Servo motor4;

void setup() {
  Serial.println(78);
  Serial.begin(9600);
  Serial.println("ACM calibrating procedure");
  Serial.println(" ");
  delay(1500);
  Serial.println("Begin");
  delay(1000);
  Serial.println("This program will start the ESC.");

  motor1.attach(MOTOR1_PIN);
  motor2.attach(MOTOR2_PIN);
  motor3.attach(MOTOR3_PIN);
  motor4.attach(MOTOR4_PIN);

  Serial.print("Now writing maximum output: (");
  Serial.print(MAX_SIGNAL);Serial.print(" us in this case)");
  Serial.print("\n");
  Serial.println("Turn on power source, then wait 2 seconds and press any key.");
  motor1.writeMicroseconds(MY_Min);
  motor2.writeMicroseconds(MY_Min);
  motor3.writeMicroseconds(MY_Min);
  motor4.writeMicroseconds(MY_Min);

  // Wait for input
  while (!Serial.available());
  
  Serial.read();

  // Send min output
  Serial.println("\n");
  Serial.println("\n");
  Serial.print("Sending minimum output: ("); //Default speed
  Serial.print(MIN_SIGNAL); //CHANGED MIN_SIGNAL
  Serial.print(" us in this case)");
  Serial.print("\n");
  motor1.writeMicroseconds(MIN_SIGNAL);
  motor2.writeMicroseconds(MIN_SIGNAL);
  motor3.writeMicroseconds(MIN_SIGNAL);
  motor4.writeMicroseconds(MIN_SIGNAL);
  Serial.println("The ESC is calibrated");
  Serial.println("----");
  Serial.println("Now, type a values between 1000 and 2000 and press enter");
  Serial.println("and the motor will start rotating.");
  Serial.println("Send 1000 to stop the motor and 2000 for full throttle");
  Serial.println("You can also use 1064 to for minimum amount of output");

}

void loop() {
   
  if (Serial.available() > 0)
  {
    int DELAY = Serial.parseInt();
    if (DELAY > 999)
    {
      
      motor1.writeMicroseconds(DELAY);
      motor2.writeMicroseconds(DELAY);
      motor3.writeMicroseconds(DELAY);
      motor4.writeMicroseconds(DELAY);
      float SPEED = (DELAY-1000)/10;
      Serial.print("\n");
      Serial.println("Motor speed:"); Serial.print("  "); Serial.print(SPEED); Serial.print("%"); 
    }     
  }
}
